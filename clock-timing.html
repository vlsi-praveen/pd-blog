<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clock & Timing Projects for Physical Design Engineers</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            color: #333;
            background: #f8f9fa;
        }
        .nav-bar {
            background: #0f3460;
            padding: 10px 20px;
            text-align: center;
        }
        .nav-bar a {
            color: white;
            text-decoration: none;
            margin: 0 12px;
            font-size: 0.9em;
        }
        .nav-bar a:hover {
            text-decoration: underline;
        }
        .nav-bar a.active {
            font-weight: bold;
            border-bottom: 2px solid #64B5F6;
        }
        .header-banner {
            background: linear-gradient(135deg, #0a2540 0%, #0f3460 50%, #1a5f8a 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
        }
        .header-banner h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .header-banner .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .header-banner .meta {
            margin-top: 20px;
            font-size: 0.95em;
            opacity: 0.8;
        }
        .view-counter {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #0a2540;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 1em;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        .view-counter span {
            font-weight: bold;
            color: #64B5F6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h2 {
            color: #0a2540;
            font-size: 1.8em;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #0f3460;
        }
        h3 {
            color: #0f3460;
            font-size: 1.4em;
            margin: 30px 0 15px 0;
        }
        h4 {
            color: #333;
            font-size: 1.1em;
            margin: 20px 0 10px 0;
        }
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        pre {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85em;
            line-height: 1.5;
            margin: 20px 0;
        }
        code {
            font-family: 'Consolas', 'Monaco', monospace;
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
        }
        pre code {
            background: none;
            padding: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #0f3460;
            color: white;
        }
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        .toc {
            background: #e3f2fd;
            padding: 25px;
            border-radius: 8px;
            margin: 30px 0;
        }
        .toc h3 {
            margin-top: 0;
            color: #0f3460;
        }
        .toc ol {
            margin-left: 25px;
        }
        .toc li {
            margin: 8px 0;
        }
        .toc a {
            color: #0f3460;
            text-decoration: none;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        .project-card {
            background: linear-gradient(to right, #f8f9fa, #e3f2fd);
            border-left: 4px solid #0f3460;
            padding: 20px;
            margin: 25px 0;
            border-radius: 0 8px 8px 0;
        }
        .project-card h3 {
            margin-top: 0;
            color: #0f3460;
        }
        .interview-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 20px;
            border-radius: 8px;
            margin: 30px 0;
        }
        .interview-box h3 {
            color: #856404;
            margin-top: 0;
        }
        .tip-box {
            background: #d1ecf1;
            border: 1px solid #17a2b8;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .tip-box h4 {
            color: #0c5460;
            margin-top: 0;
        }
        .warning-box {
            background: #f8d7da;
            border: 1px solid #dc3545;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .warning-box h4 {
            color: #721c24;
            margin-top: 0;
        }
        .tags {
            margin-top: 30px;
        }
        .tag {
            display: inline-block;
            background: #e3f2fd;
            color: #0f3460;
            padding: 5px 12px;
            border-radius: 20px;
            margin: 5px;
            font-size: 0.85em;
        }
        .diagram {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Consolas', monospace;
            font-size: 0.85em;
            overflow-x: auto;
            white-space: pre;
            margin: 20px 0;
        }
        .blog-nav {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .blog-nav a {
            color: #0f3460;
            text-decoration: none;
            font-weight: 500;
        }
        .blog-nav a:hover {
            text-decoration: underline;
        }
        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }
        ul, ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }
        li {
            margin: 5px 0;
        }
        hr {
            border: none;
            border-top: 1px solid #ddd;
            margin: 40px 0;
        }
    </style>
</head>
<body>

<div class="nav-bar">
    <a href="index.html">01: Floorplan</a>
    <a href="routing.html">02: Routing</a>
    <a href="clock-timing.html" class="active">03: Clock & Timing</a>
    <a href="power.html">04: Power</a>
    <a href="sta-verification.html">05: STA & DRC/LVS</a>
    <a href="e2e.html">06: End-to-End</a>
</div>

<div class="header-banner">
    <h1>Clock & Timing Projects</h1>
    <p class="subtitle">Master CTS, MCMM Analysis & Timing Closure Techniques</p>
    <p class="meta"><strong>Praveen Kumar Vagala</strong> | 25 min read</p>
</div>

<div class="view-counter">
    Views: <span id="visit-count">1000</span>
</div>

<div class="container">

    <h2>Introduction</h2>
    <p>
        Clock Tree Synthesis (CTS) and timing closure are the heart of physical design. A well-balanced clock tree ensures proper synchronization, while timing closure guarantees the design meets all setup/hold requirements across all corners. This blog covers 5 essential clock and timing projects.
    </p>

    <div class="toc">
        <h3>Table of Contents</h3>
        <ol>
            <li><a href="#cts-alu">Clock Tree Synthesis for ALU</a></li>
            <li><a href="#cts-multi">CTS Optimization for Multi-Clock Design</a></li>
            <li><a href="#setup-hold">Setup & Hold Fixing Using ECOs</a></li>
            <li><a href="#mcmm">Multi-Corner Multi-Mode (MCMM) Analysis</a></li>
            <li><a href="#ocv">On-Chip Variation (OCV) Analysis</a></li>
        </ol>
    </div>

    <hr>

    <!-- Project 1: CTS for ALU -->
    <div class="project-card" id="cts-alu">
        <h3>1. Clock Tree Synthesis for ALU</h3>
        <p><strong>Key Learning:</strong> Clock tree building, skew balancing, insertion delay</p>
        <p><strong>Tools:</strong> Innovus CTS / ICC2 Clock Opt</p>
    </div>

    <h4>CTS Fundamentals</h4>
    <div class="diagram">                    Clock Source
                         â”‚
                    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                    â”‚ Root    â”‚
                    â”‚ Buffer  â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼          â–¼          â–¼
           â”Œâ”€â”€â”´â”€â”€â”   â”Œâ”€â”€â”´â”€â”€â”   â”Œâ”€â”€â”´â”€â”€â”
           â”‚ L1  â”‚   â”‚ L1  â”‚   â”‚ L1  â”‚
           â”‚ Buf â”‚   â”‚ Buf â”‚   â”‚ Buf â”‚
           â””â”€â”€â”¬â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”˜
              â”‚         â”‚         â”‚
           â”Œâ”€â”€â”´â”€â”€â”   â”Œâ”€â”€â”´â”€â”€â”   â”Œâ”€â”€â”´â”€â”€â”
           â”‚ L2  â”‚   â”‚ L2  â”‚   â”‚ L2  â”‚
           â””â”€â”€â”¬â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”˜
              â”‚         â”‚         â”‚
         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”´â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
         FF  FF  FF FF  FF  FF  FF  FF

    Key Metrics:
    - Insertion Delay: Time from source to sink
    - Skew: Difference between max and min delays
    - Latency: Average delay to all sinks</div>

    <h4>CTS Spec Definition</h4>
    <pre># Define clock tree specification
create_ccopt_clock_tree_spec -file cts_spec.tcl

# Clock tree specification file
set_ccopt_property target_max_trans 0.15
set_ccopt_property target_skew 0.05
set_ccopt_property target_insertion_delay 0.5
set_ccopt_property buffer_cells {CLKBUF_X1 CLKBUF_X2 CLKBUF_X4 CLKBUF_X8}
set_ccopt_property inverter_cells {CLKINV_X1 CLKINV_X2 CLKINV_X4}

# Define clock root
create_ccopt_clock_tree -name clk_tree \
    -source clk \
    -no_skew_group

# Add clock sinks
set_ccopt_property sink_type -pin */CLK -value stop

# Exclude certain paths
set_ccopt_property sink_type -pin reset_sync*/D -value exclude

# Define skew groups for critical paths
create_ccopt_skew_group -name critical_group \
    -sources clk \
    -auto_sinks</pre>

    <h4>CTS Execution</h4>
    <pre># Set CTS mode
setCTSMode -engine ccopt

# Clock tree synthesis
ccopt_design -cts

# Report clock tree
report_ccopt_clock_trees > reports/cts_summary.rpt
report_ccopt_skew_groups > reports/skew_groups.rpt

# Detailed clock tree report
proc report_clock_tree_details {} {
    set clocks [all_clocks]
    
    foreach clk $clocks {
        puts "Clock: $clk"
        puts "  Insertion Delay: [get_attribute $clk insertion_delay]"
        puts "  Skew: [get_attribute $clk skew]"
        puts "  Latency: [get_attribute $clk latency]"
        puts "  Buffer Count: [sizeof_collection [get_cells -hierarchical -filter {is_clock_network_cell==true}]]"
    }
}

# Analyze clock tree topology
report_clock_tree_topology -levels 5 > reports/cts_topology.rpt</pre>

    <h4>CTS Quality Metrics</h4>
    <table>
        <tr>
            <th>Metric</th>
            <th>Target</th>
            <th>Impact</th>
        </tr>
        <tr>
            <td>Skew</td>
            <td>&lt; 50ps</td>
            <td>Affects setup/hold margin</td>
        </tr>
        <tr>
            <td>Insertion Delay</td>
            <td>&lt; 500ps</td>
            <td>Affects clock latency</td>
        </tr>
        <tr>
            <td>Transition</td>
            <td>&lt; 150ps</td>
            <td>Affects power, noise</td>
        </tr>
        <tr>
            <td>Capacitance</td>
            <td>Balanced</td>
            <td>Affects skew</td>
        </tr>
        <tr>
            <td>Buffer Count</td>
            <td>Minimal</td>
            <td>Affects area, power</td>
        </tr>
    </table>

    <hr>

    <!-- Project 2: Multi-Clock CTS -->
    <div class="project-card" id="cts-multi">
        <h3>2. CTS Optimization for Multi-Clock Design</h3>
        <p><strong>Key Learning:</strong> Multiple clock domains, clock crossing, balancing</p>
        <p><strong>Tools:</strong> Innovus / ICC2</p>
    </div>

    <h4>Multi-Clock Architecture</h4>
    <div class="diagram">        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  SoC Block                  â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
        â”‚  â”‚ CPU     â”‚         â”‚ Periph  â”‚           â”‚
  clk_cpuâ”€â”€â–ºâ”‚ Domain  â”‚   CDC   â”‚ Domain  â”‚â—„â”€â”€clk_periph
        â”‚  â”‚ 1GHz    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ 100MHz  â”‚           â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
        â”‚       â”‚                   â”‚                 â”‚
        â”‚       â–¼                   â–¼                 â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
        â”‚  â”‚ Memory  â”‚         â”‚ IO      â”‚           â”‚
  clk_memâ”€â”€â–ºâ”‚ Domain  â”‚         â”‚ Domain  â”‚â—„â”€â”€clk_io
        â”‚  â”‚ 500MHz  â”‚         â”‚ 200MHz  â”‚           â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

    <h4>Multi-Clock CTS Script</h4>
    <pre># Define multiple clocks
create_clock -name clk_cpu -period 1.0 [get_ports clk_cpu]
create_clock -name clk_mem -period 2.0 [get_ports clk_mem]
create_clock -name clk_periph -period 10.0 [get_ports clk_periph]
create_clock -name clk_io -period 5.0 [get_ports clk_io]

# Create clock tree specs for each domain
create_ccopt_clock_tree -name cpu_tree -source clk_cpu
create_ccopt_clock_tree -name mem_tree -source clk_mem
create_ccopt_clock_tree -name periph_tree -source clk_periph
create_ccopt_clock_tree -name io_tree -source clk_io

# Set different targets per domain
set_ccopt_property target_skew 0.03 -clock_tree cpu_tree
set_ccopt_property target_skew 0.05 -clock_tree mem_tree
set_ccopt_property target_skew 0.10 -clock_tree periph_tree

# Balance inter-clock latencies for CDC paths
create_ccopt_inter_clock_balance_group -name cpu_mem_cdc \
    -clocks {clk_cpu clk_mem}

# Run multi-clock CTS
ccopt_design -cts

# Optimize each domain
ccopt_design -postCTS -hold

# Report per-domain metrics
foreach tree {cpu_tree mem_tree periph_tree io_tree} {
    puts "Clock Tree: $tree"
    report_ccopt_clock_tree_structure -clock_tree $tree
}</pre>

    <h4>CDC Path Handling</h4>
    <pre># Identify CDC paths
set cdc_paths [get_timing_paths -from [all_registers -clock clk_cpu] \
                                 -to [all_registers -clock clk_mem]]

# Set false paths for async crossings
set_false_path -from [get_clocks clk_cpu] -to [get_clocks clk_periph]
set_false_path -from [get_clocks clk_periph] -to [get_clocks clk_cpu]

# Set multicycle for known CDC paths
set_multicycle_path 2 -from [get_pins cdc_sync*/Q] -to [get_pins cdc_sync*/D]

# Balance synchronizer latencies
proc balance_cdc_latency {} {
    set sync_regs [get_cells -hierarchical -filter "ref_name=~*SYNC*"]
    
    foreach reg $sync_regs {
        set clk_src [get_attribute $reg clock_source]
        set clk_dst [get_attribute $reg clock]
        
        # Ensure balanced arrival at synchronizer
        set_clock_latency_adjustment $reg 0.05
    }
}</pre>

    <hr>

    <!-- Project 3: Setup/Hold ECO -->
    <div class="project-card" id="setup-hold">
        <h3>3. Setup & Hold Fixing Using ECOs</h3>
        <p><strong>Key Learning:</strong> ECO techniques, buffer insertion, cell sizing</p>
        <p><strong>Tools:</strong> Innovus / ICC2</p>
    </div>

    <h4>Timing Violation Types</h4>
    <div class="diagram">Setup Violation:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Data arrives AFTER clock edge + setup time      â”‚
â”‚                                                 â”‚
â”‚  CLK  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                 â”‚â† Setup Time                   â”‚
â”‚  DATA â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“                      â”‚
â”‚                         â”‚ LATE!                 â”‚
â”‚                         â–¼                       â”‚
â”‚  Fix: Speed up data path (upsize, less logic)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Hold Violation:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Data changes BEFORE hold time after clock       â”‚
â”‚                                                 â”‚
â”‚  CLK  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
â”‚                 â”‚â†’ Hold Time                    â”‚
â”‚  DATA â”â”â”â”â”â”â”â”“                                  â”‚
â”‚              â”‚ EARLY!                           â”‚
â”‚              â–¼                                  â”‚
â”‚  Fix: Slow down data path (add buffers)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

    <h4>ECO Setup Fix Script</h4>
    <pre># Identify setup violations
report_timing -max_paths 100 -slack_lesser_than 0 > setup_violations.rpt

# Automatic setup fixing
setOptMode -fixSetupViolation true
setOptMode -effort high

optDesign -postRoute -setup

# Manual ECO for stubborn violations
proc fix_setup_eco {path_start path_end} {
    # Get the critical path
    set path [get_timing_path -from $path_start -to $path_end]
    set slack [get_attribute $path slack]
    
    puts "Fixing path with slack: $slack"
    
    # Find cells that can be upsized
    foreach cell [get_attribute $path cells] {
        set ref [get_attribute $cell ref_name]
        set alternatives [get_lib_cells -filter "function==[get_function $ref]"]
        
        # Try larger drive strength
        foreach alt $alternatives {
            if {[get_attribute $alt drive_strength] > [get_attribute $ref drive_strength]} {
                ecoChangeCell -inst $cell -cell $alt
                puts "Upsized $cell to $alt"
                break
            }
        }
    }
}

# Example: Fix specific path
fix_setup_eco "reg_a/Q" "reg_b/D"

# Verify fix
report_timing -from reg_a/Q -to reg_b/D</pre>

    <h4>ECO Hold Fix Script</h4>
    <pre># Identify hold violations
report_timing -delay_type min -max_paths 100 -slack_lesser_than 0 > hold_violations.rpt

# Set hold fixing mode
setOptMode -fixHoldViolation true
setOptMode -holdTargetSlack 0.03
setOptMode -holdFixingCells {BUFX1 BUFX2 DELX1}

# Automatic hold fixing
optDesign -postRoute -hold

# Manual hold buffer insertion
proc fix_hold_eco {from_pin to_pin num_buffers} {
    set buf_cell "BUFX1"
    
    for {set i 0} {$i < $num_buffers} {incr i} {
        set buf_name "hold_fix_${from_pin}_${i}"
        ecoAddRepeater -term $to_pin -cell $buf_cell -name $buf_name
        puts "Inserted hold buffer: $buf_name"
    }
}

# Fix specific hold path
fix_hold_eco "reg_a/Q" "reg_b/D" 2

# Alternative: Use delay cells
proc insert_delay_cell {from_pin to_pin delay} {
    set delay_cell "DELY_X1"  # Delay cell from library
    ecoAddRepeater -term $to_pin -cell $delay_cell -name "delay_fix"
}</pre>

    <h4>ECO Summary Table</h4>
    <table>
        <tr>
            <th>Violation</th>
            <th>ECO Technique</th>
            <th>Command</th>
        </tr>
        <tr>
            <td>Setup (slow data)</td>
            <td>Upsize cells</td>
            <td><code>ecoChangeCell</code></td>
        </tr>
        <tr>
            <td>Setup (long wire)</td>
            <td>Insert buffer</td>
            <td><code>ecoAddRepeater</code></td>
        </tr>
        <tr>
            <td>Hold (fast data)</td>
            <td>Add delay buffer</td>
            <td><code>ecoAddRepeater</code></td>
        </tr>
        <tr>
            <td>Transition</td>
            <td>Upsize driver</td>
            <td><code>ecoChangeCell</code></td>
        </tr>
        <tr>
            <td>Capacitance</td>
            <td>Split load</td>
            <td><code>ecoAddRepeater</code></td>
        </tr>
    </table>

    <hr>

    <!-- Project 4: MCMM -->
    <div class="project-card" id="mcmm">
        <h3>4. Multi-Corner Multi-Mode (MCMM) Analysis</h3>
        <p><strong>Key Learning:</strong> PVT corners, operating modes, constraint management</p>
        <p><strong>Tools:</strong> Innovus / PrimeTime</p>
    </div>

    <h4>MCMM Concept</h4>
    <div class="diagram">MCMM Analysis Matrix:
                    
         Corners (PVT)      Operating Modes
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ SS  - Slow-Slow â”‚    â”‚ func  - Normal   â”‚
    â”‚ FF  - Fast-Fast â”‚    â”‚ test  - Scan     â”‚
    â”‚ TT  - Typical   â”‚    â”‚ sleep - Low Powerâ”‚
    â”‚ SF  - Slow-Fast â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ FS  - Fast-Slow â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Analysis Views = Corners Ã— Modes

    Example:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚            â”‚   func   â”‚   test   â”‚  sleep   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ SS_0.9V    â”‚ Setup âœ“  â”‚ Setup âœ“  â”‚    -     â”‚
    â”‚ FF_1.1V    â”‚ Hold  âœ“  â”‚ Hold  âœ“  â”‚    -     â”‚
    â”‚ TT_1.0V    â”‚  Both    â”‚    -     â”‚  Hold    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

    <h4>MCMM Setup Script</h4>
    <pre># Define library sets for each corner
create_library_set -name lib_ss \
    -timing [list ss_0p9v_125c.lib] \
    -si [list ss_0p9v_125c_ccs.lib]

create_library_set -name lib_ff \
    -timing [list ff_1p1v_m40c.lib] \
    -si [list ff_1p1v_m40c_ccs.lib]

create_library_set -name lib_tt \
    -timing [list tt_1p0v_25c.lib]

# Define RC corners
create_rc_corner -name rc_max \
    -qrc_tech max_qrc.tech \
    -T 125

create_rc_corner -name rc_min \
    -qrc_tech min_qrc.tech \
    -T -40

create_rc_corner -name rc_typ \
    -qrc_tech typ_qrc.tech \
    -T 25

# Define delay corners
create_delay_corner -name dc_ss_max \
    -library_set lib_ss \
    -rc_corner rc_max

create_delay_corner -name dc_ff_min \
    -library_set lib_ff \
    -rc_corner rc_min

create_delay_corner -name dc_tt_typ \
    -library_set lib_tt \
    -rc_corner rc_typ

# Define constraint modes
create_constraint_mode -name func_mode \
    -sdc_files [list func.sdc]

create_constraint_mode -name test_mode \
    -sdc_files [list test.sdc]

# Create analysis views
create_analysis_view -name view_ss_func \
    -delay_corner dc_ss_max \
    -constraint_mode func_mode

create_analysis_view -name view_ff_func \
    -delay_corner dc_ff_min \
    -constraint_mode func_mode

create_analysis_view -name view_ss_test \
    -delay_corner dc_ss_max \
    -constraint_mode test_mode

# Set active views
set_analysis_view -setup {view_ss_func view_ss_test} \
                  -hold {view_ff_func}</pre>

    <h4>MCMM Timing Analysis</h4>
    <pre># Report timing across all views
proc report_mcmm_timing {} {
    set views [all_analysis_views]
    
    foreach view $views {
        puts "========== View: $view =========="
        set_analysis_view -setup $view -hold $view
        
        report_timing -max_paths 10 -view $view
        
        set wns [get_attribute [current_design] worst_negative_slack]
        set tns [get_attribute [current_design] total_negative_slack]
        
        puts "WNS: $wns, TNS: $tns"
    }
}

# Find corner-specific violations
proc find_corner_violations {} {
    set ss_paths [get_timing_paths -view view_ss_func -slack_lesser_than 0]
    set ff_paths [get_timing_paths -view view_ff_func -delay_type min -slack_lesser_than 0]
    
    puts "Setup violations (SS): [sizeof_collection $ss_paths]"
    puts "Hold violations (FF): [sizeof_collection $ff_paths]"
}

# MCMM optimization
set_analysis_view -setup {view_ss_func} -hold {view_ff_func}
optDesign -postRoute</pre>

    <hr>

    <!-- Project 5: OCV -->
    <div class="project-card" id="ocv">
        <h3>5. On-Chip Variation (OCV) Analysis</h3>
        <p><strong>Key Learning:</strong> OCV derating, AOCV, POCV, timing margins</p>
        <p><strong>Tools:</strong> PrimeTime / Innovus</p>
    </div>

    <h4>OCV Concepts</h4>
    <div class="diagram">On-Chip Variation Sources:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Process Variation                              â”‚
â”‚  â”œâ”€â”€ Across Die (Systematic)                    â”‚
â”‚  â”‚   â””â”€â”€ Gradients in lithography, CMP         â”‚
â”‚  â””â”€â”€ Within Die (Random)                        â”‚
â”‚      â””â”€â”€ Random dopant fluctuation              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Voltage Variation                              â”‚
â”‚  â””â”€â”€ IR drop across power grid                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Temperature Variation                          â”‚
â”‚  â””â”€â”€ Hotspots from switching activity           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

OCV Derating for Setup:
  Launch Path: Nominal delay (or -derate for pessimism)
  Capture Path: +derate (slower)

OCV Derating for Hold:
  Launch Path: +derate (faster) 
  Capture Path: Nominal (or slower)</div>

    <h4>OCV Analysis Script</h4>
    <pre># Set flat OCV derating
set_timing_derate -early 0.95 -cell_delay
set_timing_derate -late 1.05 -cell_delay
set_timing_derate -early 0.97 -net_delay
set_timing_derate -late 1.03 -net_delay

# Enable OCV analysis
setAnalysisMode -analysisType onChipVariation
setAnalysisMode -cppr both  ;# Clock path pessimism removal

# Run timing with OCV
timeDesign -postRoute -setup -OCV
timeDesign -postRoute -hold -OCV

# Report OCV impact
proc report_ocv_impact {} {
    # Compare with and without OCV
    setAnalysisMode -analysisType single
    set slack_no_ocv [get_timing_paths -max_paths 1]
    
    setAnalysisMode -analysisType onChipVariation
    set slack_ocv [get_timing_paths -max_paths 1]
    
    puts "Slack without OCV: $slack_no_ocv"
    puts "Slack with OCV: $slack_ocv"
    puts "OCV Impact: [expr $slack_no_ocv - $slack_ocv]"
}</pre>

    <h4>AOCV (Advanced OCV) Setup</h4>
    <pre># Load AOCV tables (stage-count and distance based)
read_lib -aocv aocv_tables.lib

# Set AOCV mode
set_timing_derate -aocv -cell_delay
setAnalysisMode -aocv true

# AOCV analysis
timeDesign -postRoute -aocv

# Report AOCV derating applied
proc report_aocv_derate {path} {
    set cells [get_attribute $path cells]
    
    foreach cell $cells {
        set early_derate [get_attribute $cell aocv_early_derate]
        set late_derate [get_attribute $cell aocv_late_derate]
        puts "Cell: $cell, Early: $early_derate, Late: $late_derate"
    }
}</pre>

    <h4>OCV/AOCV Comparison</h4>
    <table>
        <tr>
            <th>Method</th>
            <th>Derating</th>
            <th>Accuracy</th>
            <th>Pessimism</th>
        </tr>
        <tr>
            <td>Flat OCV</td>
            <td>Fixed %</td>
            <td>Low</td>
            <td>High</td>
        </tr>
        <tr>
            <td>AOCV</td>
            <td>Depth-based</td>
            <td>Medium</td>
            <td>Medium</td>
        </tr>
        <tr>
            <td>POCV</td>
            <td>Statistical</td>
            <td>High</td>
            <td>Low</td>
        </tr>
        <tr>
            <td>LVF</td>
            <td>Per-cell liberty</td>
            <td>Very High</td>
            <td>Very Low</td>
        </tr>
    </table>

    <div class="tip-box">
        <h4>ğŸ’¡ Timing Closure Tips</h4>
        <ul>
            <li>Always enable CPPR to remove clock path pessimism</li>
            <li>Use AOCV/POCV for advanced nodes (&lt;28nm)</li>
            <li>Add timing margin early, remove during ECO</li>
            <li>Fix setup first, then hold (setup affects clock tree)</li>
        </ul>
    </div>

    <hr>

    <div class="interview-box">
        <h3>Clock & Timing Interview Questions</h3>
        <ol>
            <li><strong>What is clock skew vs clock latency?</strong> - Skew is difference between arrival times; latency is absolute delay from source</li>
            <li><strong>How do you fix hold violations?</strong> - Insert delay buffers in data path</li>
            <li><strong>What is CPPR?</strong> - Clock Path Pessimism Removal: removes double-derate on common clock path</li>
            <li><strong>What corners check setup vs hold?</strong> - Slow corner for setup, fast corner for hold</li>
            <li><strong>What is the difference between OCV and AOCV?</strong> - OCV uses flat derate; AOCV uses depth/distance-based tables</li>
        </ol>
    </div>

    <h2>Next Steps</h2>
    <p>Continue your Physical Design journey with the complete blog series:</p>
    <ul>
        <li><strong>Power-Aware PD</strong> - Power grid, IR drop, multi-voltage</li>
        <li><strong>STA & Verification</strong> - SDC, DRC/LVS debugging</li>
        <li><strong>End-to-End Flow</strong> - Complete RTL to GDSII project (Coming Soon)</li>
    </ul>

    <div class="blog-nav">
        <a href="routing.html">â† Previous: Routing & Signal Integrity</a>
        <a href="power.html">Next: Power-Aware Physical Design â†’</a>
    </div>

    <div class="tags">
        <span class="tag">#PhysicalDesign</span>
        <span class="tag">#CTS</span>
        <span class="tag">#ClockTreeSynthesis</span>
        <span class="tag">#TimingClosure</span>
        <span class="tag">#MCMM</span>
        <span class="tag">#OCV</span>
        <span class="tag">#VLSI</span>
    </div>

</div>

<footer>
    <p>Physical Design examples are for educational purposes. Verify with your foundry PDK.</p>
</footer>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, runTransaction } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        databaseURL: "https://vlsi-blog-counter-default-rtdb.firebaseio.com/"
    };

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const counterRef = ref(database, 'pd03Views');

    runTransaction(counterRef, (currentValue) => {
        if (currentValue === null) return 1000;
        return currentValue + 1;
    }).then((result) => {
        document.getElementById('visit-count').textContent = result.snapshot.val();
    }).catch((error) => {
        document.getElementById('visit-count').textContent = '1000+';
    });
</script>

</body>
</html>